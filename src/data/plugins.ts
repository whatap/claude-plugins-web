import type { Plugin } from './types'

// Auto-generated by update-plugins.js
// Do not edit manually - changes will be overwritten

export const plugins: Plugin[] = [
  {
    name: 'jira-issue',
    version: '1.1.0',
    description: 'Jira 이슈 조회 스킬. PR 리뷰 시 관련 이슈를 자동으로 확인하고, 티켓 상세 정보를 조회할 수 있습니다. 댓글 작성 기능도 지원합니다.',
    category: 'development',
    keywords: ["공통","skill","jira","pr-review"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/jira-issue',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS","Linux","Windows"],
    readme: `# Jira Issue Viewer

Jira 이슈 정보를 조회하는 Claude Code 스킬입니다.

## Features

- Jira 이슈 상세 정보 조회
- PR 리뷰 시 관련 이슈 빠른 확인
- 컬러 출력으로 가독성 향상

## Prerequisites

- **jq**: JSON 파싱용
- **curl**: API 호출용
- **Jira API Token**: Atlassian 계정의 API 토큰

## Installation

Claude Code에서 플러그인을 설치하면 자동으로 \`/jira-issue\` 스킬을 사용할 수 있습니다.

## Environment Variables

다음 환경변수를 설정해야 합니다:

\`\`\`bash
# 필수
export JIRA_EMAIL="your-email@whatap.io"
export JIRA_API_TOKEN="your-api-token"

# 선택 (기본값: https://whatap-labs.atlassian.net)
export JIRA_BASE_URL="https://your-domain.atlassian.net"
\`\`\`

### API 토큰 발급 방법

1. [Atlassian API Token 관리](https://id.atlassian.com/manage-profile/security/api-tokens) 페이지 접속
2. "Create API token" 클릭
3. 토큰 이름 입력 후 생성
4. 생성된 토큰을 \`JIRA_API_TOKEN\` 환경변수에 설정

## Usage

Claude Code에서 다음과 같이 사용합니다:

\`\`\`
/jira-issue SERVER-1448
\`\`\`

### 출력 예시

\`\`\`
══════════════════════════════════════════════════════════════
[SERVER-1448] 메트릭 수집 성능 개선
══════════════════════════════════════════════════════════════

타입:      Task
상태:      In Progress
우선순위:  High
담당자:    홍길동
보고자:    김철수
라벨:      performance, backend
생성일:    2024-01-15
수정일:    2024-01-20

── 설명 ──────────────────────────────────────────────────────
메트릭 수집 시 병목 현상 발생. 배치 처리 방식으로 변경 필요.

══════════════════════════════════════════════════════════════
URL: https://whatap-labs.atlassian.net/browse/SERVER-1448
\`\`\`

## Use Cases

1. **PR 리뷰 시**: 커밋 메시지나 PR 제목의 티켓 번호로 이슈 내용 확인
2. **작업 시작 전**: 할당된 이슈의 상세 요구사항 확인
3. **코드 리뷰 시**: 변경 사항이 이슈 요구사항과 일치하는지 검증

## License

MIT
`,
  },
  {
    name: 'notification-hook',
    version: '1.0.0',
    description: '작업 완료/입력 대기 시 macOS 데스크톱 알림을 제공합니다. Claude Code가 오래 걸리는 작업을 완료하거나 사용자 입력이 필요할 때 알림을 받을 수 있습니다.',
    category: 'productivity',
    keywords: ["공통","hook","notification","macos"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/notification-hook',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS"],
    readme: `# notification-hook

Claude Code 작업 완료/입력 대기 시 macOS 데스크톱 알림을 보내는 Hook 플러그인

## 기능

| Hook | 이벤트 | 설명 |
|------|--------|------|
| Notification | idle_prompt | 입력 대기 시 알림 |
| Notification | permission_prompt | 권한 요청 시 알림 |
| Stop | - | 작업 완료 시 알림 |
| PostToolUse | Bash (30초+) | 장시간 명령 완료 시 알림 |

## 요구사항

- macOS
- jq (\`brew install jq\`)
- terminal-notifier (권장, \`brew install terminal-notifier\`)

## 설치

### 마켓플레이스에서 설치
\`\`\`bash
# 마켓플레이스 추가
/plugin marketplace add whatap/claude-plugins

# 플러그인 설치
/plugin install notification-hook@whatap-claude-plugins
\`\`\`

### 수동 설치
\`\`\`bash
# 1. 스크립트 복사
mkdir -p ~/.claude/hooks
cp scripts/*.sh ~/.claude/hooks/
chmod +x ~/.claude/hooks/*.sh

# 2. settings.json에 Hook 추가
# ~/.claude/settings.json 또는 .claude/settings.json
\`\`\`

## 설정 예시

\`\`\`json
{
  "hooks": {
    "Notification": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/notify.sh"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/notify-stop.sh"
          }
        ]
      }
    ]
  }
}
\`\`\`

## 태그

- 공통
- hook
- notification
- macos

## 라이선스

MIT
`,
  }
]

export function getPluginByName(name: string): Plugin | undefined {
  return plugins.find((p) => p.name === name)
}

export function searchPlugins(query: string, category?: string, tags?: string[]): Plugin[] {
  return plugins.filter((plugin) => {
    // Search query
    if (query) {
      const q = query.toLowerCase()
      const matchesQuery =
        plugin.name.toLowerCase().includes(q) ||
        plugin.description.toLowerCase().includes(q) ||
        plugin.keywords.some((k) => k.toLowerCase().includes(q))
      if (!matchesQuery) return false
    }

    // Category filter
    if (category && category !== 'all' && plugin.category !== category) {
      return false
    }

    // Tags filter
    if (tags && tags.length > 0) {
      const hasTag = tags.some((tag) =>
        plugin.keywords.some((k) => k.toLowerCase() === tag.toLowerCase())
      )
      if (!hasTag) return false
    }

    return true
  })
}
