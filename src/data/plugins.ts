import type { Plugin } from './types'

// Auto-generated by update-plugins.js
// Do not edit manually - changes will be overwritten

export const plugins: Plugin[] = [
  {
    name: 'jira',
    version: '3.1.0',
    description: 'Jira 통합 스킬 - 이슈 조회(/jira KEY), 생성(/jira new), 코멘트 추가',
    category: 'development',
    keywords: ["공통","skill","jira","pr-review"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/jira',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS","Linux","Windows"],
    readme: `# Jira 통합 스킬

Jira 이슈 조회, 생성, 코멘트 추가를 지원하는 Claude Code 스킬입니다.

## Features

- \`/jira KEY\` - 이슈 상세 정보 조회 (예: \`/jira SERVER-123\`)
- \`/jira new\` - 새 이슈 생성 (대화형)
- \`/jira comment KEY "내용"\` - 이슈에 코멘트 추가

### 조회 기능

- 이슈 상세 정보 (메타, 설명, 서브태스크, 코멘트)
- 첨부파일 자동 다운로드
- 이미지 인라인 표시 (Claude가 이미지 확인 가능)
- ADF (Atlassian Document Format) → Markdown 완전 변환

### 생성 기능

- 대화형으로 새 이슈 생성
- 담당자 미지정 시 본인으로 자동 설정
- KUBER 프로젝트 "개선" 이슈 타입 지원

## Prerequisites

- **Node.js 18+**: native fetch 지원 필요
- **Jira API Token**: Atlassian 계정의 API 토큰

## Installation

\`\`\`
/plugin install jira@whatap-claude-plugins
\`\`\`

## Environment Variables

\`\`\`bash
# 필수
export JIRA_EMAIL="your-email@whatap.io"
export JIRA_API_TOKEN="your-api-token"

# 선택 (기본값: https://whatap-labs.atlassian.net)
export JIRA_URL="https://your-domain.atlassian.net"
\`\`\`

### API 토큰 발급 방법

1. [Atlassian API Token 관리](https://id.atlassian.com/manage-profile/security/api-tokens) 페이지 접속
2. "Create API token" 클릭
3. 토큰 이름 입력 후 생성
4. 생성된 토큰을 \`JIRA_API_TOKEN\` 환경변수에 설정

## Usage

### 이슈 조회

\`\`\`
/jira SERVER-1448
\`\`\`

### 이슈 생성

\`\`\`
/jira new
\`\`\`

### 이슈에 코멘트 추가

\`\`\`
/jira comment SERVER-1448 "확인했습니다. 수정 진행하겠습니다."
\`\`\`

## Changelog

### v3.0.0

- **Breaking**: 플러그인 이름 변경 \`jira-issue\` → \`jira\`
- **Breaking**: \`/jira-new\` 스킬을 \`/jira new\` 서브커맨드로 통합
- 단일 스킬로 조회, 생성, 코멘트 모두 지원

### v2.1.0

- 이슈 생성 기능 추가 (\`/jira-new\`)
- 담당자 자동 설정

### v2.0.0

- Node.js 기반으로 완전 재작성
- 첨부파일 다운로드, 이미지 인라인 표시

### v1.0.0

- 초기 릴리스 (Bash 기반)

## License

MIT
`,
  },
  {
    name: 'mxql',
    version: '1.0.0',
    description: 'dev.whatap.io에서 MXQL 쿼리를 실행합니다. 파일, 인라인 쿼리, stdin(heredoc) 모두 지원. Chrome 쿠키 인증 사용.',
    category: 'development',
    keywords: ["dbx","skill","mxql","개발환경"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/mxql',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS"],
    readme: `# mxql - MXQL 쿼리 실행 플러그인

dev.whatap.io의 flush API를 통해 MXQL 쿼리를 실행하는 Claude Code 스킬입니다.

## 기능

- **3가지 입력 방식 지원**
  - 파일: \`./query.mql\`
  - 인라인: \`'CATEGORY x TAGLOAD SELECT'\`
  - stdin: heredoc으로 복잡한 쿼리 입력
- Chrome 쿠키 기반 인증 (별도 로그인 불필요)
- 시간 범위 지정 옵션

## 설치

### 1. 플러그인 설치

\`\`\`bash
/plugin install mxql@whatap-claude-plugins
\`\`\`

### 2. Python venv 설정

플러그인 설치 후 최초 1회 venv를 설정해야 합니다:

\`\`\`bash
# 플러그인 디렉토리로 이동 (설치 위치 확인 필요)
cd ~/.claude/plugins/mxql/skills/mxql

# venv 생성 및 패키지 설치
python3 -m venv venv
source venv/bin/activate
pip install browser_cookie3 requests
\`\`\`

### 3. Chrome 로그인

dev.whatap.io에 Chrome으로 로그인합니다:
- URL: https://dev.whatap.io
- 계정 정보: 사내 문서 참조

## 사용법

### 파일에서 읽기

\`\`\`bash
/mxql 878 ./query.mql
\`\`\`

### 인라인 쿼리

\`\`\`bash
# 작은따옴표로 감싸기
/mxql 878 'CATEGORY db_postgresql_tables TAGLOAD SELECT LIMIT 5'
\`\`\`

### stdin (heredoc)

쌍따옴표가 많은 복잡한 쿼리에 유용:

\`\`\`bash
~/.claude/plugins/mxql/skills/mxql/run.sh 878 - <<'EOF'
CATEGORY db_postgresql_tables
FILTER oname == "dev-pg-rds"
TAGLOAD
SELECT [time, oname, tablename, total]
LIMIT 10
EOF
\`\`\`

## 입력 자동 판단

1. \`-\` → stdin에서 읽기
2. 파일이 존재하면 → 파일에서 읽기
3. 그 외 → 인라인 쿼리로 처리

## 예시 쿼리 파일

\`examples/\` 디렉토리에 샘플 쿼리가 있습니다:

- \`tagload.mql\` - 기본 TAGLOAD 쿼리
- \`filter_select.mql\` - FILTER와 SELECT 사용 예시

## 요구사항

- macOS (browser_cookie3의 Chrome 쿠키 접근)
- Python 3.8+
- Chrome 브라우저
- Dev VPN 연결

## 문제 해결

### Chrome 쿠키 접근 오류

1. Chrome이 실행 중이면 종료 후 재시도
2. Chrome에서 dev.whatap.io 로그인 상태 확인
3. Keychain Access에서 Chrome Safe Storage 접근 허용

### venv 관련 오류

\`\`\`bash
# venv 재생성
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install browser_cookie3 requests
\`\`\`

## 라이선스

MIT
`,
  },
  {
    name: 'notification-hook',
    version: '1.0.0',
    description: '작업 완료/입력 대기 시 macOS 데스크톱 알림을 제공합니다. Claude Code가 오래 걸리는 작업을 완료하거나 사용자 입력이 필요할 때 알림을 받을 수 있습니다.',
    category: 'productivity',
    keywords: ["공통","hook","notification","macos"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/notification-hook',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS"],
    readme: `# notification-hook

Claude Code 작업 완료/입력 대기 시 macOS 데스크톱 알림을 보내는 Hook 플러그인

## 기능

| Hook | 이벤트 | 설명 |
|------|--------|------|
| Notification | idle_prompt | 입력 대기 시 알림 |
| Notification | permission_prompt | 권한 요청 시 알림 |
| Stop | - | 작업 완료 시 알림 |
| PostToolUse | Bash (30초+) | 장시간 명령 완료 시 알림 |

## 요구사항

- macOS
- jq (\`brew install jq\`)
- terminal-notifier (권장, \`brew install terminal-notifier\`)

## 설치

### 마켓플레이스에서 설치
\`\`\`bash
# 마켓플레이스 추가
/plugin marketplace add whatap/claude-plugins

# 플러그인 설치
/plugin install notification-hook@whatap-claude-plugins
\`\`\`

### 수동 설치
\`\`\`bash
# 1. 스크립트 복사
mkdir -p ~/.claude/hooks
cp scripts/*.sh ~/.claude/hooks/
chmod +x ~/.claude/hooks/*.sh

# 2. settings.json에 Hook 추가
# ~/.claude/settings.json 또는 .claude/settings.json
\`\`\`

## 설정 예시

\`\`\`json
{
  "hooks": {
    "Notification": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/notify.sh"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "~/.claude/hooks/notify-stop.sh"
          }
        ]
      }
    ]
  }
}
\`\`\`

## 태그

- 공통
- hook
- notification
- macos

## 라이선스

MIT
`,
  },
  {
    name: 'skill-authoring-review',
    version: '1.1.1',
    description: 'Claude Code 스킬 작성 및 검증 도구. 새로운 스킬 초기화, 기존 스킬 검증, Anthropic 공식 가이드라인 준수 여부 확인을 지원합니다.',
    category: 'development',
    keywords: ["공통","skill","개발도구","검증"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/skill-authoring-review',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS","Linux","Windows"],
    readme: `# Skill Authoring & Review

Claude Code 스킬 작성 및 검증 도구입니다. Anthropic 공식 가이드라인을 기반으로 합니다.

## Features

- 새로운 스킬 초기화 (디렉토리 구조 + 템플릿)
- 기존 스킬 검증 (구조, frontmatter, 스타일)
- 일괄 검증 지원 (recursive)
- 다양한 출력 형식 (text, json, markdown)

## Prerequisites

- **Python 3.9+**: 검증 스크립트 실행용
- **Bash**: 초기화 스크립트 실행용

## Installation

Claude Code에서 플러그인을 설치하면 자동으로 스킬을 사용할 수 있습니다.

## Usage

### 새 스킬 생성

\`\`\`bash
# 기본 사용법
~/.claude/skills/skill-authoring-review/scripts/init_skill.sh <skill-name> <output-directory>

# 예시
~/.claude/skills/skill-authoring-review/scripts/init_skill.sh pdf-editor ~/.claude/skills
\`\`\`

생성되는 구조:
\`\`\`
<skill-name>/
├── SKILL.md          # 메인 스킬 문서 (편집 필요)
├── scripts/          # 실행 스크립트
│   └── example.sh
├── references/       # 참조 문서
│   └── documentation.md
└── assets/           # 출력 파일용 리소스
\`\`\`

### 스킬 검증

\`\`\`bash
# 단일 스킬 검증
python3 ~/.claude/skills/skill-authoring-review/scripts/validate_skill.py ~/.claude/skills/my-skill

# 전체 스킬 검증 (재귀)
python3 ~/.claude/skills/skill-authoring-review/scripts/validate_skill.py ~/.claude/skills --recursive

# JSON 출력
python3 ~/.claude/skills/skill-authoring-review/scripts/validate_skill.py ~/.claude/skills --format json

# Markdown 리포트
python3 ~/.claude/skills/skill-authoring-review/scripts/validate_skill.py ~/.claude/skills --format markdown
\`\`\`

### 출력 예시

\`\`\`
============================================================
Skill: my-skill
Path: /Users/user/.claude/skills/my-skill
Words: 1234
Valid: Yes
============================================================

  WARNINGS:
    - [body] Found 3 second-person usage(s)
      Suggestion: Use imperative/infinitive form. Examples: L45: 'You can configure...'

  SUGGESTIONS:
    - [progressive_disclosure] SKILL.md is 1234 words (recommended: 1,500-2,000)
      Suggestion: Consider splitting into references/ if content grows
\`\`\`

## Validation Rules

### Critical (필수 수정)
- \`SKILL.md\` 파일 존재 (대문자)
- frontmatter의 \`name\` 필드
- frontmatter의 \`description\` 필드

### Warning (권장 수정)
- 디렉토리 이름과 \`name\` 필드 일치
- description 3인칭 작성
- body에서 2인칭 사용 금지 (you, your)

### Suggestion (개선 권장)
- 적정 분량: 1,500-2,000 words
- 트리거 조건 명시

## Skill Guidelines Summary

### Frontmatter 예시

\`\`\`yaml
---
name: my-skill
description: Brief description in third-person. This skill should be used when [conditions]. Triggers on requests like "[phrases]".
---
\`\`\`

### 작성 스타일

**올바른 예:**
\`\`\`markdown
To rotate a PDF, run the following command:
\`\`\`

**잘못된 예:**
\`\`\`markdown
You can rotate a PDF by running:
\`\`\`

## References

- \`references/anthropic-skill-guide.md\` - Anthropic 공식 가이드라인 요약
- \`references/validation-checklist.md\` - 상세 검증 체크리스트
- \`references/templates.md\` - 스킬 유형별 템플릿
- \`assets/minimal-skill.md\` - 최소 유효 스킬 예시

## License

MIT
`,
  },
  {
    name: 'tagcount',
    version: '1.0.0',
    description: 'dev.whatap.io에서 MXQL TAGLOAD 쿼리를 실행하여 카테고리의 tag와 field를 조회합니다. Chrome 쿠키 인증을 사용합니다.',
    category: 'development',
    keywords: ["dbx","skill","mxql","개발환경"],
    author: {
      name: 'WhaTap Labs',
      email: 'dev@whatap.io',
    },
    homepage: 'https://github.com/whatap/claude-plugins/tree/main/plugins/tagcount',
    repository: 'https://github.com/whatap/claude-plugins',
    license: 'MIT',
    platform: ["macOS"],
    readme: `# tagcount - MXQL Tag/Field 조회 플러그인

dev.whatap.io의 flush API를 통해 MXQL TAGLOAD 쿼리를 실행하여 카테고리의 tag와 field를 확인하는 Claude Code 스킬입니다.

## 기능

- MXQL TAGLOAD 쿼리 자동 생성 및 실행
- Chrome 쿠키 기반 인증 (별도 로그인 불필요)
- tag/field 자동 분류
- 샘플 데이터 표시

## 설치

### 1. 플러그인 설치

\`\`\`bash
/plugin install tagcount@whatap-claude-plugins
\`\`\`

### 2. Python venv 설정

플러그인 설치 후 최초 1회 venv를 설정해야 합니다:

\`\`\`bash
# 플러그인 디렉토리로 이동 (설치 위치 확인 필요)
cd ~/.claude/plugins/tagcount/skills/tagcount

# venv 생성 및 패키지 설치
python3 -m venv venv
source venv/bin/activate
pip install browser_cookie3 requests
\`\`\`

### 3. Chrome 로그인

dev.whatap.io에 Chrome으로 로그인합니다:
- URL: https://dev.whatap.io
- 계정 정보: 사내 문서 참조

## 사용법

\`\`\`bash
# Claude Code에서
/tagcount 878 db_postgresql_tables

# MySQL 테이블
/tagcount 1627 db_mysql_tables

# Oracle 세션
/tagcount 123 db_oracle_session
\`\`\`

## 출력 예시

\`\`\`json
{
  "tags": ["pname", "oname", "datname", "schemaname", "tablename"],
  "fields": ["table", "index", "total"],
  "sample_data": {
    "time": 1770024025000,
    "pcode": 878,
    "pname": "postgres-v2-test",
    "oname": "dev-pg-rds",
    "datname": "db1",
    "schemaname": "public",
    "tablename": "kwlee",
    "table": 40960,
    "index": 0,
    "total": 40960,
    "oid": 78064568
  }
}
\`\`\`

## 요구사항

- macOS (browser_cookie3의 Chrome 쿠키 접근)
- Python 3.8+
- Chrome 브라우저
- Dev VPN 연결

## 문제 해결

### Chrome 쿠키 접근 오류

1. Chrome이 실행 중이면 종료 후 재시도
2. Chrome에서 dev.whatap.io 로그인 상태 확인
3. Keychain Access에서 Chrome Safe Storage 접근 허용

### venv 관련 오류

\`\`\`bash
# venv 재생성
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install browser_cookie3 requests
\`\`\`

## 라이선스

MIT
`,
  }
]

export function getPluginByName(name: string): Plugin | undefined {
  return plugins.find((p) => p.name === name)
}

export function searchPlugins(query: string, category?: string, tags?: string[]): Plugin[] {
  return plugins.filter((plugin) => {
    // Search query
    if (query) {
      const q = query.toLowerCase()
      const matchesQuery =
        plugin.name.toLowerCase().includes(q) ||
        plugin.description.toLowerCase().includes(q) ||
        plugin.keywords.some((k) => k.toLowerCase().includes(q))
      if (!matchesQuery) return false
    }

    // Category filter
    if (category && category !== 'all' && plugin.category !== category) {
      return false
    }

    // Tags filter
    if (tags && tags.length > 0) {
      const hasTag = tags.some((tag) =>
        plugin.keywords.some((k) => k.toLowerCase() === tag.toLowerCase())
      )
      if (!hasTag) return false
    }

    return true
  })
}
